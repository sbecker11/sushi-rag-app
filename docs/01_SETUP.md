# Setup Guide

Complete setup and configuration guide for the Sushi RAG App.

## Quick Start

### Prerequisites
- Node.js 16+ installed
- Docker Desktop installed and running
- OpenAI API key (optional, for AI features)

### Installation Steps

```bash
# 1. Install all dependencies
npm run install-all

# 2. Create .env file from template
cp env.example .env

# 3. Edit .env and add your OpenAI API key (optional)
# nano .env

# 4. Set up database (one-time)
npm run db:setup

# 5. Start everything!
npm run dev
```

That's it! The app will be available at:
- **Frontend:** http://localhost:5173
- **Backend API:** http://localhost:3001

---

## Environment Configuration

### .env File Location

Create `.env` in the **root directory** with the following configuration:

### Required Variables

```env
# Backend Configuration
PORT=3001

# PostgreSQL Docker Container Configuration
POSTGRES_CONTAINER=sushi-rag-app-postgres
POSTGRES_USER=sushi_rag_user
POSTGRES_PASSWORD=sushi_rag_password
POSTGRES_DB=sushi_rag_orders
POSTGRES_HOST=localhost
POSTGRES_PORT=5432

# ChromaDB Configuration (Vector Database)
CHROMA_HOST=localhost
CHROMA_PORT=8000

# OpenAI Configuration (optional for AI features)
OPENAI_API_KEY=your_openai_api_key_here

# Frontend URL (for CORS)
FRONTEND_URL=http://localhost:5173

# Performance Monitoring (optional)
ENABLE_PERFORMANCE_LOGGING=true
```

### Customization

#### Change Container Names

Each developer can have unique container names to avoid conflicts:

```env
# Developer A
POSTGRES_CONTAINER=sushi-rag-app-postgres-alice

# Developer B
POSTGRES_CONTAINER=sushi-rag-app-postgres-bob
```

#### Change Ports

```env
POSTGRES_PORT=5433  # Use different port
CHROMA_PORT=8001
```

---

## OpenAI API Key Setup

### Do I Need It?

**No, it's optional!** The app works without it:
- ‚úÖ **Without key:** Uses static sushi menu (8 pre-configured items)
- ‚ú® **With key:** Menu generated by GPT-4, plus AI assistant chat

### How to Get an OpenAI API Key

#### Step 1: Create Account

1. Go to https://platform.openai.com/
2. Click "Sign Up" or "Log In"
3. Complete registration

#### Step 2: Add Payment Method

OpenAI requires a payment method (pay-as-you-go):

1. Go to https://platform.openai.com/account/billing
2. Add credit/debit card
3. **Optional:** Set usage limits (e.g., $5/month)

#### Step 3: Create API Key

1. Navigate to https://platform.openai.com/api-keys
2. Click "Create new secret key"
3. Name it (e.g., "sushi-rag-app")
4. Copy the key (starts with `sk-`)
5. **Save it securely** - you won't see it again!

#### Step 4: Add to .env

```bash
# Edit .env file
OPENAI_API_KEY=sk-your-actual-key-here
```

#### Step 5: Restart App

```bash
# Stop with Ctrl+C, then:
npm run dev
```

### Cost Estimates

Typical usage costs:
- **Menu generation:** $0.01-0.02 per request
- **Embeddings:** $0.0001 per item
- **Chat queries:** $0.01-0.03 per conversation
- **Monthly (light use):** $1-5

### Free Alternatives

If you don't want to pay:
1. Use the static menu (works great!)
2. Use OpenAI free trial credits (if available)
3. Use a different LLM provider (requires code changes)

---

## Troubleshooting

### Can't Find .env File

The `.env` file should be in the root directory, **not** in `/backend`:

```
sushi-rag-app/
‚îú‚îÄ‚îÄ .env          ‚Üê HERE!
‚îú‚îÄ‚îÄ backend/
‚îú‚îÄ‚îÄ frontend/
‚îî‚îÄ‚îÄ docker-compose.yml
```

### Environment Variables Not Loading

1. **Check file name**: Must be exactly `.env` (not `.env.txt`)
2. **Check location**: Root directory
3. **Restart services**: Changes require restart
   ```bash
   # Stop: Ctrl+C
   npm run dev
   ```

### OpenAI API Key Not Working

Check for:
- **Whitespace:** No spaces around the key
- **Quotes:** Don't use quotes: `OPENAI_API_KEY=sk-...` (not `"sk-..."`)
- **Valid key:** Starts with `sk-`
- **Active account:** Check billing at https://platform.openai.com/account/billing

### Docker Services Not Found

Make sure Docker Desktop is running:
```bash
open -a Docker
# Wait for green icon in menu bar
npm run dev
```

### Port Already in Use

```bash
# Clean up ports
npm run kill:ports

# Then restart
npm run dev
```

---

## Configuration Examples

### Development Environment

```env
PORT=3001
POSTGRES_CONTAINER=sushi-rag-app-postgres-dev
POSTGRES_DB=sushi_rag_orders_dev
ENABLE_PERFORMANCE_LOGGING=true
OPENAI_API_KEY=sk-...
```

### Production Environment

```env
PORT=3000
POSTGRES_CONTAINER=sushi-rag-app-postgres-prod
POSTGRES_DB=sushi_rag_orders_prod
ENABLE_PERFORMANCE_LOGGING=false
OPENAI_API_KEY=sk-...
```

### Multiple Developers

Each developer can customize without conflicts:

**Alice's .env:**
```env
POSTGRES_CONTAINER=sushi-postgres-alice
POSTGRES_PORT=5433
CHROMA_PORT=8001
```

**Bob's .env:**
```env
POSTGRES_CONTAINER=sushi-postgres-bob
POSTGRES_PORT=5434
CHROMA_PORT=8002
```

---

## Next Steps

Once setup is complete:

1. ‚úÖ **Test the app:** http://localhost:5173
2. ‚úÖ **Try the AI chat:** Click "ü§ñ Ask AI" button
3. ‚úÖ **Check status:** http://localhost:3001/api/assistant/status
4. üìñ **Learn about AI features:** See AI_FEATURES.md
5. üê≥ **Understand Docker:** See DOCKER.md

---

## Quick Reference

### Start Application
```bash
npm run dev
```

### Stop Application
```bash
# Press Ctrl+C in terminal
npm run docker:down  # Stop Docker services
```

### Reset Everything
```bash
npm run docker:reset  # Reset Docker with fresh data
npm run db:setup      # Reinitialize database
```

### Check Status
```bash
# Check Docker services
docker ps

# Check AI services
curl http://localhost:3001/api/assistant/status

# Check performance logging
# Look for ‚è±Ô∏è timing logs in backend console
```

### Update Dependencies
```bash
npm run install-all
```

---

## Getting Help

If you're stuck:
1. Check this guide's troubleshooting section
2. Review error messages in terminal
3. Check Docker logs: `docker-compose logs`
4. Verify .env configuration
5. Try docker reset: `npm run docker:reset`

**Common issues are usually:**
- Docker not running
- Incorrect .env configuration
- Port conflicts
- Missing OpenAI API key (for AI features)

